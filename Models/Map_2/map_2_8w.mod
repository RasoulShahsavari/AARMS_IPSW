param n;
param m:=2;
param d:=8;
set D, default{1..d};
set N, default{1..n};
set M, default{1..m};
var x1{N,M};
set E, within N cross N;
param w1{D,M};
var e{E,M}, >=0;
var c{E,D},binary;
param l{E};
param v{N,M};
var q{N,M}, >=0;

minimize obj: sum{(i,j) in E}(e[i,j,1]+e[i,j,2])+ sum{j in N}(q[j,1]+q[j,2]);

s.t. c1{k in M, (i,j) in E}:e[i,j,k] >= x1[i,k]+sum{a in D} (c[i,j,a]*w1[a,k]*l[i,j])-x1[j,k];
s.t. c2{k in M, (i,j) in E}:e[i,j,k] >= -x1[i,k]-sum{a in D}(c[i,j,a]*w1[a,k]*l[i,j])+x1[j,k];
s.t. c3{k in M, (i,j) in E}: x1[i,k]-v[i,k]<= q[j,k];
s.t. c4{k in M, i in N}: -x1[i,k]+v[i,k]<= q[i,k];
s.t. c5{(i,j) in E}: sum{k in D }c[i,j,k]=1;
solve;
display x1,e,q,c;

printf "Vertex location: \n";
printf "index\tx\ty\n";
printf{i in N} "%d\t%g\t%g\n", i, x1[i,1], x1[i,2];

data;

param n:=24;
param  w1:     1    2:=
1	0.707106781	0.707106781
2	0	1
3	-0.707106781	0.707106781
4	-1	0
5	-0.707106781	-0.707106781
6	0	-1
7	0.707106781	-0.707106781
8	1	0;

param: E : l :=
1    2    420.0047618777695
2    3    265
3    4    433.01039248498415
4    5    297.1952220342716
5    6    186.59314028120113
6    7    233.43093196955715
7    8    383.25578925783265
8    9    184.16568627164492
9    10    273.7535387899123
10    11    308.0259729308553
11    12    377.8901956923127
12    13    237.39418695502476
13    14    437.73279520730455
14    15    417.8097653238852
15    16    318.9874605685935
16    1    91.24143795401397
1    17    229.71504086562283
17    16    186.4242473499625
16    3    273.70787347096905
3    17    114.58621208504974
17    2    248.2438317461282
2    4    348.28293096274473
4    8    628.984101547885
8    11    630.1571232636677
14    11    311.0064308014312
14    12    371.40005385075244
9    11    474.5239719972006
18    11    200.2498439445428
18    19    339.52466773417217
18    20    201.16162655934158
20    14    131.88252348207476
20    21    302.2730553656229
13    22    179.2344832893492
10    23    225.00222221124633
23    9    149.05368160544967
9    24    209.8809186184575
24    8    238.05251521460553
23    24    163.44112089679268
;

param  v:     1    2:=
1	90	94
2	510	91
3	351	303
4	784	306
5	977	80
6	1161	49
7	1298	239
8	1329	620
9	1175	721
10	946	871
11	702	683
12	382	885
13	148	844
14	439	517
15	22	491
16	105	183
17	290	206
18	692	483
19	1026	544
20	507	404
21	207	367
22	127	666
23	1171	870
24	1334	858;   

end;



